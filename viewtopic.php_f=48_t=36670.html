<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>


<style type="text/css">
#global { width: 100%; }
</style>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />


<title>Lancers Reactor Forums &bull; View topic - VB and FL_CODEC</title>

<link href="./styles/ca_orbital/theme/stylesheet.css" rel="stylesheet" type="text/css" media="screen, projection" />
<link media="only screen and (max-device-width: 480px)" href="./styles/ca_orbital/theme/iphone.css" type="text/css" rel="stylesheet" />

</head>

<body id="phpbb" class="section- ltr">
<div id="main">

<p class="top"><a id="top" name="top" accesskey="t"></a></p>

<div id="global" style="margin: 0 auto;">

    <p class="skiplink"><a href="#start_here">Skip to content</a></p>

	<!-- header start -->
    <div id="topnav">
        <div class="left"></div>
        <div class="right"></div>
        <ul class="linklist topnav leftside">
            <li>
                <a href="https://the-starport.com" title="The Starport">The Starport</a>
            </li>
            <li>
                <span>&bull;</span>
                <a href="https://the-starport.net/discord" title="The Starport Discord">Discord</a>
            </li>
        </ul>
    </div>
    

	<div id="logo"><a href="./index.php.html"><img src="./styles/ca_orbital/imageset/tlr_logo.png" alt="" title=""><span>Lancers Reactor Forums</span></a></div>
	<!-- header end -->

    <div id="page-header-msg">
		<div class="block-header"><span></span><div></div></div>
       <div class="block-content"><div class="block-inner"><div class="block-inner2">
            	
		<table width="100%">
			<tbody><tr><td style="text-align:center;width:100%;">

            <h2 style="color:red;">Important Message</h2>
            <h3>You are browsing the archived Lancers Reactor forums. You cannot register or login.<br>
            The content may be outdated and links may not be functional.</h3><br>
            <h4>To get the latest in Freelancer news, mods, modding and downloads, go to<br>
            	<a href="https://the-starport.com">The-Starport</a></h4>
    	</td></tr> 
    </tbody></table>
    
    	</div></div></div>
    <div class="block-footer"><span></span><div></div></div>
	</div>
    <p></p>
	<div id="page-header">
		<div class="navbar navbar-top" id="navbar-top">
            <div class="block-header"><span></span><div></div></div>
            <div class="block-content"><div class="block-inner"><div class="block-inner2">
            <ul class="linklist navlinks">
                <li class="icon-home"><span class="home-extra"><a href="./index.php.html" accesskey="h">Board index</a>  <strong>&#8249;</strong> <a href="./viewforum.php_f=75.html">Freelancer Editing</a> <strong>&#8249;</strong> </span><a href="./viewforum.php_f=48.html">Help Wanted/Available Section</a></li>
            </ul>
            <div class="block-clear"></div>
            </div></div></div>
            <div class="block-footer"><span></span><div></div></div>
		</div>
	</div>
    <p></p>

	<a name="start_here"></a>

	<div id="page-body">
		<div id="content-start"></div>
<h2 class="leftside"><a href="./viewtopic.php_f=48_t=36670" id="topic-title">VB and FL_CODEC</a></h2>

<p class="rightside">
    
</p>
<div class="clear"></div>
<p class="forum-desc">Advertise for Modelers, Programmers, Webmasters, INI Editors, Script Experts, Adventurers, Servers, or anything that has to do with a project</p>

<div class="topic-actions">

	<div class="buttons">
	
		<div class="reply-icon"><a href="" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="pagination">
			2 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	

</div>
<div class="clear"></div>


	<div id="p27523" class="post">
		<div class="block-border block-block block-post block-post-first"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-0" href="javascript:void(0);">BlackIce2006</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Mon Dec 13, 2004 6:15 am <span class="post-author-inline" style="display: none;">by BlackIce2006</span></p>

			<h3 class="first"><a href="#p27523" class="post-subject">VB and FL_CODEC</a></h3>

			

			<div class="content">Hi 
<br />I'm going to use the VB Code of the FLCodec File.
<br />I wrote an Programm in C++ to create a textfile of a *.fl file. But now I'm going to try this in VB for using in a new program. 
<br />The decleration of this dll is :
<br />Public Declare Function flcodec Lib &quot;c:\windows\system32\flcodec.dll&quot; (ByVal nType As Long, ByVal szSource As String, ByVal szDest As String) As Long
<br />
<br />a) if i declare this function as public the program returned an error because to declare a function in the main-decleration is not allowed
<br />b) There is given a variable named &quot;nType&quot; . Should be a &quot;Long&quot;. What number is preferred by the dll? I tried it out with 0,1 and 2. But: No effect, no error, no systemcrash.... 
<br />
<br />I will be happy if someone has an idea how to fix my problem.
<br />
<br />Sorry for my mistakes. Only a pupil and from Germany <img src=smilies/icon_smile_wink.gif width=15 height=15 border=0 align=middle></div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>


	<div id="p345624" class="post">
		<div class="block-border block-block block-post"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-1" href="javascript:void(0);">WatercoolerWarrior</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Tue Dec 14, 2004 3:19 am <span class="post-author-inline" style="display: none;">by WatercoolerWarrior</span></p>

			<h3><a href="#p345624" class="post-subject"></a></h3>

			

			<div class="content">BlackIce,
<br />we'll muddle through. Your English is much better than my German. <img src=smilies/icon_smile.gif width=15 height=15 border=0 align=middle>
<br />
<br />I think all of your problems are due to some requirements of VB for certain uses. I assume you are writing this as a VB application? If so, and if you are declaring this in your Form code, the problem is that you can't make it public there since it can't be shared from a Form. If your application source code is just the Form, make it &quot;Private Declare&quot;.
<br />
<br />Here's how I declare the function and the flags. I use names that are somewhat &quot;friendlier&quot; to non-coders:
<br />
<br />&lt;pre&gt;&lt;font size=1 face=Courier&gt;
<br />Private Declare Function flcodec Lib &quot;flcodec&quot; _
<br />  (ByVal codecFlag As Long, ByVal sourcePath As String, _
<br />  ByVal targetPath As String) As Long
<br />
<br />' flcodec flags
<br />Private Const FLCODEC_DECODE = &amp;H1
<br />Private Const FLCODEC_ENCODE = &amp;H2
<br /> &lt;/font&gt;&lt;/pre&gt;
<br />
<br />Note also that I  ABSOLUTELY DO NOT use an explicit complete path to flcodec.dll - i just say &quot;flcodec&quot;. If it is in the same folder as your application or in your system search path, the application will have no problem finding the file. Specifying the full path is an invitation to breakage.
<br />
<br />OK, now that I've said that... here's how I use it. You can paste the following function into your form code and then call the function with the original savegame path and the new path as arguments. If the file is decoded successfully, it returns True. If it fails, it returns False. If flcodec wasn't found, it spits an error message out.
<br />
<br />
<br />&lt;pre&gt;&lt;font size=1 face=Courier&gt;
<br />Private Function EncodeSaveGame(ByVal sourcePath As String, _
<br />  ByVal targetPath As String) As Boolean
<br />  On Error GoTo CodecError:
<br />  Dim MyLastCodecError As Boolean
<br />  MyLastCodecError = flcodec(FLCODEC_ENCODE, sourcePath, targetPath)
<br />  On Error GoTo 0
<br />  If MyLastCodecError = 0 Then
<br />    EncodeSaveGame = True
<br />  Else
<br />    EncodeSaveGame = False
<br />  End If
<br />  Exit Function
<br />CodecError:
<br />  Err.Raise Err.Number, TypeName(Me), _
<br />    &quot;Error calling flcodec.dll. Make certain it is available in your path or the current working directory.&quot;
<br />End Function 
<br /> &lt;/font&gt;&lt;/pre&gt;</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>



<div class="topic-actions">
	<div class="buttons" id="viewtopic-buttons">
	
		<div class="reply-icon"><a href="" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="pagination">
			2 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	
</div>


	<p></p><p><a href="./viewforum.php_f=48" class="left-box left" accesskey="r">Return to Help Wanted/Available Section</a></p>

	<br /><br />
</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
</div>

	<div id="footer-clear">&nbsp;</div>
	<div class="copyright">
        <br />Hosted by <a href="https://the-starport.com">The Starport</a> &bull; Theme by <a href="https://www.stsoftware.biz/" ref="nofollow">ST Software</a>
	</div>


</div><!-- #global -->

</div>
</body>
</html>