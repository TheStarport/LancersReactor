<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>


<style type="text/css">
#global { width: 100%; }
</style>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />


<title>Lancers Reactor Forums &bull; View topic - **Tutorial** - Ships/Weapons w/ multiple components</title>

<link href="./styles/ca_orbital/theme/stylesheet.css" rel="stylesheet" type="text/css" media="screen, projection" />
<link media="only screen and (max-device-width: 480px)" href="./styles/ca_orbital/theme/iphone.css" type="text/css" rel="stylesheet" />

</head>

<body id="phpbb" class="section- ltr">
<div id="main">

<p class="top"><a id="top" name="top" accesskey="t"></a></p>

<div id="global" style="margin: 0 auto;">

    <p class="skiplink"><a href="#start_here">Skip to content</a></p>

	<!-- header start -->
    <div id="topnav">
        <div class="left"></div>
        <div class="right"></div>
        <ul class="linklist topnav leftside">
            <li>
                <a href="https://the-starport.com" title="The Starport">The Starport</a>
            </li>
            <li>
                <span>&bull;</span>
                <a href="https://the-starport.net/discord" title="The Starport Discord">Discord</a>
            </li>
        </ul>
    </div>
    

	<div id="logo"><a href="./index.php.html"><img src="./styles/ca_orbital/imageset/tlr_logo.png" alt="" title=""><span>Lancers Reactor Forums</span></a></div>
	<!-- header end -->

    <div id="page-header-msg">
		<div class="block-header"><span></span><div></div></div>
       <div class="block-content"><div class="block-inner"><div class="block-inner2">
            	
		<table width="100%">
			<tbody><tr><td style="text-align:center;width:100%;">

            <h2 style="color:red;">Important Message</h2>
            <h3>You are browsing the archived Lancers Reactor forums. You cannot register or login.<br>
            The content may be outdated and links may not be functional.</h3><br>
            <h4>To get the latest in Freelancer news, mods, modding and downloads, go to<br>
            	<a href="https://the-starport.com">The-Starport</a></h4>
    	</td></tr> 
    </tbody></table>
    
    	</div></div></div>
    <div class="block-footer"><span></span><div></div></div>
	</div>
    <p></p>
	<div id="page-header">
		<div class="navbar navbar-top" id="navbar-top">
            <div class="block-header"><span></span><div></div></div>
            <div class="block-content"><div class="block-inner"><div class="block-inner2">
            <ul class="linklist navlinks">
                <li class="icon-home"><span class="home-extra"><a href="./index.php.html" accesskey="h">Board index</a>  <strong>&#8249;</strong> <a href="./viewforum.php_f=75.html">Freelancer Editing</a> <strong>&#8249;</strong> </span><a href="./viewforum.php_f=29.html">Freelancer Editing Tutorial Forum</a></li>
            </ul>
            <div class="block-clear"></div>
            </div></div></div>
            <div class="block-footer"><span></span><div></div></div>
		</div>
	</div>
    <p></p>

	<a name="start_here"></a>

	<div id="page-body">
		<div id="content-start"></div>
<h2 class="leftside"><a href="./viewtopic.php_f=29_t=21416" id="topic-title">**Tutorial** - Ships/Weapons w/ multiple components</a></h2>

<p class="rightside">
    
</p>
<div class="clear"></div>
<p class="forum-desc">Here you find the different tutorials on editing and MODing Freelancer</p>

<div class="topic-actions">

	<div class="buttons">
	
		<div class="reply-icon"><a href="" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="pagination">
			7 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	

</div>
<div class="clear"></div>


	<div id="p14605" class="post">
		<div class="block-border block-block block-post block-post-first"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-0" href="javascript:void(0);">redeye</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Tue Jul 15, 2003 12:59 pm <span class="post-author-inline" style="display: none;">by redeye</span></p>

			<h3 class="first"><a href="#p14605" class="post-subject">**Tutorial** - Ships/Weapons w/ multiple components</a></h3>

			

			<div class="content">So far i have only completed this for ships but the actual model data in a weapon is in the same format as a ship so this should apply directly.  The most obvious difference is the Hps - an HpMount for the base, presumably the same as a ships HpMount, an HpConnect for the base and an HpFire0X for the barrel i doubt these will prove too difficult to understand.
<br />
<br />So here is the method for ships.  I highly recommend downloading the version of the Battleaxe which has destructable parts as it will provide a good reference point.  Get it <a href='http://www.lancersreactor.com/t/download/download.asp?id=441' Target=_Blank>here</a>.  It is also a good idea to look over HCls VMesh guide, which is <a href='http://lancersreactor.com/t/editing/features/details.asp?id=8' Target=_Blank>here</a>.  There are 3 main steps to having a ship composed of separate components :
<br />
<br />1.  Correctly defining what vertexes/triangles from your model form the various components - This information is contained in the VMeshLibrary -&gt; Name_of_ship.lodX.vms -&gt; <b>VMeshData   </b> node and the Name_of_ship/component.3db -&gt; Multilevel -&gt; LevelX - <b>VmeshRef   </b> nodes.
<br />
<br />2.  Correctly positioning the components relative to the hull - This information is contained in the Cmpnd -&gt; Cons -&gt; Fix node (for moving parts i.e. weapon barrels it is the Rev node).  This node also has alot of other information which so far i dont know anything about.  It is involved in how components take damage and how they appear when a ship is destroyed.
<br />
<br />3.  Setting up the part as a destructable component - This information is contained in the ships entry in shiparch.ini
<br />
<br />There are several features of game ships which seem redundant.  Removing them all from a game ship seems to make absolutely no difference to how the ship/components behave.  As i see no purpose for them i havnt included them, tho it is quite possible i have overlooked something.  Things not included :
<br />
<br />Components .sur and .3db files.  
<br />Components {Simple} entry in shiparch.ini (this points to the .3db file)
<br />Harpoint 'DpName_of_component' on hull.
<br />
<br />You can try removing all these things from a game ships and its components appear to behave exactly the same.  The kusari blood dragon is a good ship to try it on because it has obvious components.
<br />
<br />Also i have not included any LOD information.  Setting up the various lod's is the same as for a one part ship.  You must make 4 versions of the model, each witha different name i.e. ship.lod0, ship.lod1 etc. and export to 4 .cmps.  Then you must import the different VMeshData segments from the 4 .cmps into the same file.  Then you must correctly define all the various parts in each lod in its appropriate name_of_component.3db -&gt; Multilevel -&gt; level X node.  
<br />
<br /><b>Step 1   </b> - Correctly defining what vertexes/triangles form each component.  
<br />
<br />Create your model as normal in milkshape, remembering to assign a material to each component.  Before you add the Hps decide what parts you want as separate components and regroup them - the main hull should still be the first group with the components after it.  Game ships have 2 groups for destructable components, the fist of which is destroyed and the second remains so a hole isnt left in the hull.  However the same effect can be achieved by hiding all you components in milshape and adding faces to the hull which will only be seen if a component is destroyed.  In the Battleaxe they are just flat faces but you could easily added jagged edges with a burnt texture.  It does not  matter what you call the components in milkshape but you must know the order in which they come after the hull.
<br />
<br />Add your Hps as normal.  Note down which Hps are going to be associated with each component eg. in the Battleaxe the third group is the port wing and it has HpWeapon04 on it.  Now export your model as a .cmp.
<br />
<br />
<br />
<br />Edited by - Chips on 10/31/2004 8:17:06 AM</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>


	<div id="p175992" class="post">
		<div class="block-border block-block block-post"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-1" href="javascript:void(0);">redeye</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Tue Jul 15, 2003 1:06 pm <span class="post-author-inline" style="display: none;">by redeye</span></p>

			<h3><a href="#p175992" class="post-subject"></a></h3>

			

			<div class="content">You now have a .cmp file which you should open with FLUTF.  The first node is <b>VMeshLibrary -&gt; name_of_hull.lod0.vms -&gt; VMeshData  </b>.  This node contains information on all the vertexas and triangles which form the model and which of these are in each group.  However it does not define the groups in the same way as a game ships so you are going to have to manually edit it with a hex editor.  Export the <b>VMeshData  </b> node to a file and open it with your editor.  The first 16 bytes are a header defined as :
<br />
<br />header
<br />{
<br />  dword 1
<br />  dword 4
<br />  word number_of_meshes
<br />  word total_number_of_referenced_vertices (in short, number_of_triangles * 3)
<br />  word fvf (0x112)
<br />  word total_number_of_vertices
<br />} = 16 bytes
<br />
<br />(from HCls VMesh guide)
<br />
<br />The header is fine, you may want to check the value for <b>number_of_meshes  </b> is correct tho.
<br />
<br />Directly after the header are the mesh segments in the format :
<br />
<br />mesh
<br />{
<br />  dword materialID
<br />  word start_vertex
<br />  word end_vertex
<br />  word number_of_referenced_vertices (as before, number_of_triangles * 3)
<br />  word padding (always 0xcc, may be a padding value, for dword allignment)
<br />} = 12 bytes
<br />
<br />One mesh segment for each group.   It is the start/end_vertex numbers you are going to be changing.  Here is the <b>VMeshData  </b> sgement from the Battleaxe with the first mesh segment in bold and the start/end_vertex numbers in italics :
<br />
<br />01 00 00 00 04 00 00 00 06 00 A5 15 12 01 AE 07
<br /><b>D5 DF 03 00  </b> <i>00 00 14 06  </i><b>91 11 CC 00  </b> D5 DF 03 00
<br />15 06 3D 06 6C 00 CC 00 D5 DF 03 00 3E 06 6B 06
<br />6C 00 CC 00 D5 DF 03 00 6C 06 91 06 48 00 CC 00
<br />D5 DF 03 00 92 06 1F 07 7A 01 CC 00 D5 DF 03 00......
<br />
<br />Each components start_vertex number must be 00 00.  The end_vertex number is what number the end_vertex would be if the start_vertex was 00 00.  So for each mesh segment you must change the start_vertex number to 00 00, then to work out the end_vertex number subtract the original start_vertex number from the original end_vertex number.  So in the case of the first mesh segment the start_vertex number is already 00 00 and the original end_vertex number minus 00 00 is still 14 06.  This is why a single mesh exported to .cmp works fine.  However the rest of the mesh segments need changing.  Here is the same VMeshData segment with the second mesh segment in bold and the start/end_vertex numbers in italic :
<br />
<br />01 00 00 00 04 00 00 00 06 00 A5 15 12 01 AE 07
<br />D5 DF 03 00 00 00 14 06 91 11 CC 00 <b>D5 DF 03 00  </b>
<br /><i>15 06 3D 06 </i><b>6C 00 CC 00  </b> D5 DF 03 00 3E 06 6B 06
<br />6C 00 CC 00 D5 DF 03 00 6C 06 91 06 48 00 CC 00
<br />D5 DF 03 00 92 06 1F 07 7A 01 CC 00 D5 DF 03 00......
<br />
<br />So the start_vertex number (15 06) becomes 00 00.  The end vertex number becomes 3D 06 - 15 06 = 28 00.  For each mesh segment make a note of the original start_vertex number as you need this for the <b>VMeshRef  </b> segment.  Also make a note of the number of vertexes and number of referenced vertexes each mesh uses.  The number of vertexes used is simply your new end_vertex number + 1 (29 00 in the above example),  the number of referenced vertexes is given correctly in the mesh segment after the end_vertex number - so in the above mesh segment it is 6C 00.  So work through all the mesh segments entering the new start/end_vertex numbers and noting down the original start_vertex number, new end vertex number + 1 and number_of_referenced vertexes.  Here is how the above segment looks once it has been modified (with start/end_vertex numbers in bold) :
<br />
<br />01 00 00 00 04 00 00 00 06 00 A5 15 12 01 AE 07
<br />D5 DF 03 00 <b>00 00 14 06  </b> 91 11 CC 00 D5 DF 03 00
<br /><b>00 00 28 00  </b> 6C 00 CC 00 D5 DF 03 00 <b>00 00 2D 00  </b>
<br />6C 00 CC 00 D5 DF 03 00 <b>00 00 25 00  </b> 48 00 CC 00
<br />D5 DF 03 00 <b>00 00 8D 00  </b> 7A 01 CC 00 D5 DF 03 00......
<br />
<br />Here are my notes for each segment in the format original start_vertex, new end_vertex + 1, number_of_referenced vertexes :
<br />
<br />Hull : 00 00, 15 06, 91 11
<br />TopFin : 15 06, 29 00, 6C 00
<br />LWing : 3E 06, 2E 00, 6C 00
<br />RWing : 6C 06, 26 00, 48 00
<br />LEngine : 92 06, 8E 00, 7A 01
<br />
<br />Once you have finished changing all the numbers save the new <b>VMeshData  </b> segment and import it back into your .cmp in place of the old one.  You next task is to create <b>VMeshRef  </b> segements for each component.  With your .cmp open in FLUTF look for a node called <b>name_of_hull.3db  </b>.  It contains a <b>Hardpoints  </b> node and a <b>Multilevel -&gt; Level0 -&gt; VMeshPart -&gt; VmeshRef  </b> node.  You must create a <b>name_of_component.3db  </b> node for each component (by clicking on the .\ node and seleting add node). 
<br />
<br />At this point you can add your hardpoints to each component - add a <b>Hardpoints  </b> node to your components .3db node, add a Fixed / Revolute node (or both if your component has both types of Hp)  now you just need to transfer the relevant Hps from your <b>name_of_hull.3db -&gt; Hardpoints  </b> node to their new location - manually of course.  Once you have done that delete the Hps node on the <b>name_of_hull.3db -&gt; Hardpoints  </b> node.  
<br />
<br />Now under each .3db node you have created you must make a <b>Multilevel -&gt; Level0 -&gt; VMeshPart -&gt; VmeshRef  </b> node.  Once you have done that locate the original <b>VMeshRef  </b> node of the hull (under <b>name_of_hull.3db -&gt; Multilevel -&gt; Level0 -&gt; VMeshPart -&gt; VmeshRef  </b>) and export it to a file.  The format of the <b>VmeshRef  </b> node is :
<br />
<br />VMeshRef
<br />{
<br />  dword 0x3c
<br />  dword VMeshID
<br />  word start_vert
<br />  word end_vert
<br />  word start_vert_reference
<br />  word end_vert_reference
<br />  word mesh_number
<br />  word number_of_meshes
<br />
<br />  float bounding_box[6 (minx, maxx, miny, maxy, minz, maxz)
<br />  float unknown[4
<br />} = 60 bytes
<br />(again from HCls guide to VMesh) 
<br />
<br />The .cmp exporter does not create any data for bounding_box or unknown.  This doesnt seem to matter tho as these pieces can be removed from game ships .cmp files with no obvious effect.  Open up your <b>VMeshRef  </b> segment in your hex editor.  The original Battleaxes segment looked like this :
<br />
<br />3C 00 00 00 F4 C1 10 F9 00 00 00 00 00 00 00 00 
<br />00 00 06 00 00 00 00 00 00 00 00 00 00 00 00 00
<br />00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
<br />00 00 00 00 00 00 00 00 00 00 00 00
<br />
<br />The reason you get away with this little information is because the only information required to display meshes is the start_vertex number, the start_vertex_reference number, the mesh_number and number_of_meshes.  So the above segment tells FL to start at vertex/vertex_reference 00 00 on the first mesh and read in 6 meshes.   You now need to create a <b>VMeshRef  </b> segment for each component using the values you noted down from before.  Start with the hull, here is the new format :
<br />
<br />VMeshRef
<br />{
<br />  dword 0x3c
<br />  dword VMeshID
<br />  word original start_vertex number from <b>VMeshData  </b> segment
<br />  word number of vertexes (new end_vertex number from <b>VMeshData  </b> + 1)
<br />  word start_vert_reference (total of number_of_vertexes_references for all preceding parts)
<br />  word number of vertexes referenced (from <b>VMeshData segment  </b>)
<br />  word mesh_number
<br />  word number_of_meshes
<br />
<br />  float bounding_box[6 (minx, maxx, miny, maxy, minz, maxz)
<br />  float unknown[4
<br />} = 60 bytes
<br />
<br />The only calculation you have to do here is working out the start_vert_reference number which is the total of number of vertexes referenced for all previous parts.  As a check you can also make sure your start_vertex number for each component is equal to the total of all previous number_of_vertexes.  So here is the new VMeshRef segment for the hull of the Battleaxe :
<br />
<br />3C 00 00 00 F4 C1 10 F9 00 00 15 06 00 00 91 11 
<br />00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00
<br />00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
<br />00 00 00 00 00 00 00 00 00 00 00 00
<br />
<br />As you can see i have added in the number_of_vertexes (15 06) and number_of_vertexes referenced (91 11).  The start_vertex/vertex reference numbers remain the same.  I have also changed number_of_meshes to 01 as the hull is only one mesh.  Save this new file as hullvmeshref (or similar) and import into the <b>name_of_hull.3db -&gt; Multilevel -&gt; Level0 -&gt; VMeshPart -&gt; VmeshRef  </b> node of your .cmp.  
<br />
<br />Now go back to your hulls <b>VmeshRef  </b> segment in the hex editor.  You now need to edit it so it applys to your first component (in the Battleaxe this is the TopFin).  You have the following numbers noted down for this component :
<br />
<br />TopFin : 15 06, 29 00, 6C 00
<br />
<br />The only number you need to calculate is the start_vertex_reference number which is the total of number_of_vertexes_referenced for each previous part.  As the only previous part is the hull the start_vertex_reference number is 91 11.  Here is the <b>VMeshRef  </b> segment for the TopFin :
<br />
<br />3C 00 00 00 F4 C1 10 F9 15 06 29 00 91 11 6C 00 
<br />01 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00
<br />00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
<br />00 00 00 00 00 00 00 00 00 00 00 00
<br />
<br />Again i have plugged in the relevant values.  Also mesh_number has changed to 01 00 as the TopFin is mesh number 1.  Note that the <b>VMeshID  </b> (in this case F4 C1 10 F9) is the same for all components and is the <b>VMeshID  </b> of the hull.  Again save this file as topfinvmeshref (or similar) and import into <b>name_of_component.3db -&gt; Multilevel -&gt; Level0 -&gt; VMeshPart -&gt; VmeshRef  </b> node of your .cmp.  
<br />
<br />The next component in the Battleaxe is the Left Wing.  From the <b>VmeshData  </b> segment i have the following information :
<br />
<br />LWing : 3E 06, 2E 00, 6C 00
<br />
<br />Again the only number we need to calculate if the start_vertex_reference number which is the total of number_of_vertexes_referenced for each previous component.  So before the Left Wing there is the hull and top fin giving a total of 91 11 + 6C 00 = FD 11.  Here is the <b>VMeshRef  </b> segment for the Left Wing :
<br />
<br />3C 00 00 00 F4 C1 10 F9 3E 06 2E 00 FD 11 6C 00 
<br />02 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00
<br />00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
<br />00 00 00 00 00 00 00 00 00 00 00 00
<br />
<br />Values from above plugged in and start_mesh number changed to 02.  Again save this and import into the relevant <b>VMeshRef  </b> node in your .cmp.
<br />
<br />Repeat this process until all your components have the correct <b>VMeshRef  </b> segments in the .cmp.  That is Step 1 complete.
<br />
<br />
<br />Edited by - redeye on 15-07-2003 14:18:41</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>


	<div id="p175993" class="post">
		<div class="block-border block-block block-post"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-2" href="javascript:void(0);">redeye</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Tue Jul 15, 2003 1:06 pm <span class="post-author-inline" style="display: none;">by redeye</span></p>

			<h3><a href="#p175993" class="post-subject"></a></h3>

			

			<div class="content"><b>Step 2 - Relative positoning of components and hull  </b>
<br />
<br />If you have managed to get this far you have done most of the hard work.  Your next task is to create a node in your .cmp under <b>Cmpnd  </b> called <b>Cons  </b> (presumably for 'Connections').  Create a node under <b>Cons  </b> called <b>Fix  </b> (for parts that can move i.e. baydoors/weapon barrels this is called <b>Rev  </b>).  This part is required for correct display of your component.  Until the data contained in it is fully worked out you are going to have to steal one from a game ship.  
<br />
<br />When deciding what ship to steal it from there are a few things to be taken into consideration.  Firstly you must steal the <b>Fix  </b> segment from the ship whose .sur file you intend to use.  Mismatching <b>Fix  </b> segments and .sur files mean a ship takes damage as the .sur file tells it to but the components dont.  Secondly you must hijack one of the game ships components for each of your components.  What original component you hijack for your component will affect how much damage it takes.  For the Battleaxe i used the Eagles .sur file and <b>Fix  </b> segment.  The wings on the Battleaxe use the segment of <b>Fix  </b> which related to the Eagles wings, the Engines use the part that related to the Eagles engines and the Topfin uses the Eagles Topfin segment.  A point to note here is that the Eagles engines are not destructable.  It does not matter whether the segment of <b>Fix  </b> you hijack for your component is destructable or not, any one will do (i.e. all ships have the glass in the cockpit as a separate part, you can steal the segment of <b>Fix  </b> for this for a destructable component).  However the relative sizes of the component you hijack affects how much damage that part will take.  So the wings on the Battleaxe are far easier to destroy than the engines, even tho they have the same hit points, because the Eagles wings are far bigger than its engines.  Once you have picked what ships .sur file you are going to use open up that ships .cmp file and export the <b>Cmpnd -&gt; Cons -&gt; Fix  </b> segment to a file.  Open with your hex editor.  Each components entry is in the following format  :
<br />
<br />&quot;Root&quot;
<br />60 bytes (unknown purpose)
<br />&quot;'name_of_component'_lod1&quot;
<br />&lt;112 bytes
<br />
<br />Total = 176 bytes
<br />
<br />Basically the &quot;'name_of_component'_lod1&quot; and the rest of the segment total 112 bytes.  Here is the segment of the Eagles <b>Fix  </b> node which relates to the Eagles Starboard Wing :
<br />
<br /><b>'R' 'o' 'o' 't'  </b> 00 3D 7C 12 A1 F7 41 00 E0 CF 13 00
<br />10 D9 24 02 03 00 00 00 34 62 87 00 00 00 00 00
<br />C8 A6 41 00 AB 14 00 11 C1 FB 41 00 39 B4 41 00
<br />5B B4 41 00 03 00 00 00 68 3D 7C 12 10 10 02 28
<br /><b>'c'  'v'  '_'  's'  't'  'a'  'r'  '_' 'w'  'i'  'n'   'g'  '_'  'l'  'o'  'd'
<br />'1'  </b> 00 7C 12 88 E6 13 00 28 F9 EB 01 68 3D 7C 12
<br />9A A2 ED 08 68 3D 7C 12 88 E6 13 00 00 00 00 00
<br />00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
<br />64 4C D3 40 6E 2E F3 3E C6 39 17 40 00 00 80 3F
<br />40 DE 4C 26 4C DE 4C A6 3F DE 4C A6 00 00 80 3F
<br />00 00 80 33 4D DE 4C 26 00 00 80 B3 00 00 80 3F
<br />
<br />I have replaced the hex for the text with the text it codes for and put it in bold.
<br />The only bit of this i understand is the bit in italics.  It defines where the origin is for each component (relative to the hull) as three floats.  The game ships <b>VMeshData  </b> segment appears to encode all the components meshes as if they are centred on the x,y,z axis.  Not as they appear on the ship.  As you have made your model with the components in the correct place on the ship the correct origin for the components is 0, 0, 0.  
<br />
<br />So for each component in your ship you must pick an original component in the <b>Fix  </b> segment and change the origin of that component to 0, 0, 0.  As three floats this will be 00 00, 00 00, 00 00.  Personally i dont like putting blocks of zeros in things (stupid i know) so i usually change the origin to 0.00000001, 0.00000001, 0.00000001 which is BD 37 86 35, BD 37 86 35, BD 37 86 35 in hex.
<br />
<br />Basically you need to pick an original component for each of your new components, change the origin (decimal address 128 - 139 in that components segment in the <b>Fix  </b> node - where the 'R' of Root is address 0) to 0, 0, 0 and note down the name of the component i.e. 'cv_star_wing_lod1' in above example.  Once you have changed the origin for as many components as you have to 0, 0, 0 save the <b>Fix  </b> segment and import into your .cmp under <b>Cmpnd -&gt; Cons -&gt; Fix </b>.
<br />
<br />That is all the hex editing you are going to have to do <img src='./images/smilies/icon_biggrin.gif' width=15 height=15 border=0 align=middle>
<br />
<br />Now you need to create a node for each of your components under the <b>Cmpnd  </b> node in the .cmp.  The name of this node should be &quot;Part_'name_of_component'&quot;.  'name_of_component'  in this case can probably be anything.  However to be on the safe side use 'name_of_component' from the <b>Fix  </b> segment.  So for the Battleaxes right wing i am using the Eagles star wing entry in  the <b>Fix  </b> segment.  Therefore the <b>Cmpnd -&gt; Part_'name_of_component'  </b> node for this is called <b>Part_cv_star_wing_lod1  </b>.  Add a <b>Part_'name_of_component'  </b> node for each one of your ships components.  Each <b>Part_'name_of_component'  </b> node has 3 sub nodes :
<br />
<br /><b>File name  </b> - String -'name_of_component.3db' this must match the name of the .3db node you created for your component in Step 1.
<br /><b>Index  </b> - 8 byte integer array - 1, 0 for first component, 2, 0 for second etc.  Doesnt seem to matter, you can probably miss this node out
<br /><b>Object name  </b> - 'name_of_component' from <b>Fix  </b> segment.
<br />
<br />So for the Battleaxes right wing i used the cv_star_wing_lod1 segment of the <b>Fix  </b> node.  I also called the 'name_of_component.3db' node 'cv_star_wing_lod1.3db' but i could have called it 'Battleaxe_right_wing.3db' as long as i entered that as the <b>Cmpnd -&gt; Part_cv_star_wing_lod1 -&gt; File name  </b> node.  So the three sub nodes for the 
<br /><b>Cmpnd -&gt; Part_cv_star_wing_lod1  </b> node in the Battleaxe are :
<br />
<br /><b>File name  </b> - cv_star_wing_lod1.3db
<br /><b>Index  </b> - 03 00 00 00 00 00 00 00
<br /><b>Object name  </b> - cv_star_wing_lod1
<br />
<br />Once you have added a <b>Cmpnd -&gt; 'Part_name_of_component'  </b> node and 3 sub nodes for each component you have finished Step 2.  At this stage if you save your .cmp and put the ship in game it should appear corretly as the complete model with all components in place.  However none of the parts will be destructable yet. 
<br />
<br /><b>Step 3 - Defining your components as being destructable in shiparch.ini  </b>
<br />
<br />This is the easiest part.  There are two entries after the main {Ship} entry for each component, a {CollisionGroup} entry and a {Simple} entry.  I see no purpose in the {Simple} entry, it refers to the components .3bd/.sur file however removal of these files and the {Simple} entry for a game ships components does not seem to make any difference.  This means the only entry you need to worry about is the {CollisionGroup} one.  The easiest way to make these is to steal the {CollisionGroup} entry from another ships component.  Here is the Eagles starboard wing {CollisionGroup} entry :
<br />
<br />{CollisionGroup}
<br />obj = cv_star_wing_lod1        
<br />separable        
<br />parent_impulse = 120.000000        
<br />child_impulse = 60.000000        
<br />debris_type = debris_small_ship        
<br />separation_explosion = explosion_small_ship_breakoff        
<br />mass = 5.000000        
<br />type = Starboard_Wing        
<br />dmg_hp = DpDmg_starwing        
<br />dmg_obj = cv_fighter4_star_wing_cap        
<br />hit_pts = 550        
<br />root_health_proxy = true        
<br />
<br />For each of your components {CollisionGroup} entrys set obj = 'name_of_component', where 'name_of_component' is the components name in the <b>Fix  </b> segment (also the same as the <b>Cmpnd -&gt; Part_'name_of_component' -&gt; Object name  </b> node).
<br />
<br />Parent/Child impulses seem to be to do with how the component is blown off.  If you hugely increase child_impulse then the component is blow miles away and you never see it.
<br />
<br />Debris_type and separation_explosion are fairly obvious.  As is mass, it possibly affects how the component behaves after is has been blown off.
<br />
<br />Type doesnt seem to make any difference, to be tidy set it to the type of object your component is (i.e. Top_Fin, Starboard_Engine etc.)
<br />
<br />dmg_hp refers to a hardpoint on the hull with the same name.  Again removing this Hp from the hull and/or screwing around with its name in the {CollisionGroup} entry seem to make no difference so you can leave this alone.
<br />
<br />dmg_obj refers to the {Simple} entry for the component.  As we are not even putting in a {Simple} entry for the component you can leave this alone too.
<br />
<br />hit_pts is obvious too.  This is how much damage your component will take before it is blown off.  Remember that the amount of damage your component takes relates to which original components entry in the <b>Fix  </b> segment you hijacked.  So for the Battleaxe the wings take far more damage from randomly directed fire than the engines because the Eagles wings are a much bigger target than the engines.  Unfortunately the component will take full missile damage even without a .sur file.  Hopefully when the <b>Fix  </b> segment and/or the .sur files are worked out this issue will be resolved.  For the time being you will have to work out some kind of compromise.  If your component is much bigger than the original component you will have to set the hit_pts quite low as only a small percentage of the damage the ship takes will get to it.  However if you set it too low then one hit from a crappy missile will blow off all the components.   
<br />
<br />root_health_proxy = true is the same for all components.  I havnt tried changing this but i expect if you do the component wont recieve damage.  Tho it is possible if you set this to false that it may start using the components .3db and .sur files to calculate damage.  I doubt this tho so just leave it as it is.
<br />
<br />Once you have completed a {CollisionGroup} entry for all your components save shiparch.ini.  Copy the .sur file from the ship which you stole the <b>Fix  </b> segment from to your ships directory and rename it yourshipname.sur.  Load up FL.  Once your shield is depleted (sell your shield to test the ship) all the components should start taking damage.  Setting each components hit_pts entries (in {CollisionGroup} in shiparch.ini) to something really low like 10 or 20 is a good way to test if everything is working, then you can increase them accordingly.
<br />
<br />Thats it.  Hopefully you now have a ship with components which blow off after taking a certain amount of damage, taking any Hps on them away.  Remember to check the Battleaxes .cmp file if you are getting lost, it might even be a good idea to use battleaxe.cmp as a template, importing your various <b>VMeshData/Ref  </b> segments into it and renaming nodes accordingly.  Good luck.
<br />
<br />Edited by - redeye on 15-07-2003 16:03:10</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>


	<div id="p259615" class="post">
		<div class="block-border block-block block-post"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-3" href="javascript:void(0);">ColinS</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Wed Mar 10, 2004 3:46 pm <span class="post-author-inline" style="display: none;">by ColinS</span></p>

			<h3><a href="#p259615" class="post-subject"></a></h3>

			

			<div class="content">Thanks for the tutorial, it helped a lot.</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>


	<div id="p260828" class="post">
		<div class="block-border block-block block-post"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-4" href="javascript:void(0);">Glitch</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Sat Mar 13, 2004 3:29 pm <span class="post-author-inline" style="display: none;">by Glitch</span></p>

			<h3><a href="#p260828" class="post-subject"></a></h3>

			

			<div class="content">Wow!  That's a lot of hex.  Don't suppose someone is willing to write an editor to make this kind of thing any easier?
<br />
<br />(This site is best viewed with your eyes open)</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>


	<div id="p265816" class="post">
		<div class="block-border block-block block-post"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-5" href="javascript:void(0);">redeye</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Sun Mar 28, 2004 5:30 am <span class="post-author-inline" style="display: none;">by redeye</span></p>

			<h3><a href="#p265816" class="post-subject"></a></h3>

			

			<div class="content">Harrier seems to be on top of the overall issue, so maybe he's the man to get the whole issue wrapped up in a util.
<br />
<br />Meantime, alot of the tedious hex editing can be removed by using <a href='http://www.lancersreactor.com/t/forum/topic.asp?TOPIC_ID=21849&amp;FORUM_ID=30&amp;CAT_ID=9&amp;Topic_Title=Single+mesh+%2D%26gt%3B+Multiple+mesh+VMeshData%2FRef+converter+uploaded&amp;Forum_Title=Freelancer+Editing+Utilities+Forum&amp;M=False&amp;S=True' Target=_Blank>this util</a>.</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>


	<div id="p366556" class="post">
		<div class="block-border block-block block-post"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-6" href="javascript:void(0);">Cold_Void</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Wed May 04, 2005 10:04 pm <span class="post-author-inline" style="display: none;">by Cold_Void</span></p>

			<h3><a href="#p366556" class="post-subject"></a></h3>

			

			<div class="content">Is there an updated tutorial for making a multi component ship with meshconv that i missed or has that just not been done yet?</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>



<div class="topic-actions">
	<div class="buttons" id="viewtopic-buttons">
	
		<div class="reply-icon"><a href="" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="pagination">
			7 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	
</div>


	<p></p><p><a href="./viewforum.php_f=29" class="left-box left" accesskey="r">Return to Freelancer Editing Tutorial Forum</a></p>

	<br /><br />
</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
</div>

	<div id="footer-clear">&nbsp;</div>
	<div class="copyright">
        <br />Hosted by <a href="https://the-starport.com">The Starport</a> &bull; Theme by <a href="https://www.stsoftware.biz/" ref="nofollow">ST Software</a>
	</div>


</div><!-- #global -->

</div>
</body>
</html>