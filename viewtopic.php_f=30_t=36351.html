<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>


<style type="text/css">
#global { width: 100%; }
</style>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />


<title>Lancers Reactor Forums &bull; View topic - Freelancer &quot;linting&quot; script - commandline junkies</title>

<link href="./styles/ca_orbital/theme/stylesheet.css" rel="stylesheet" type="text/css" media="screen, projection" />
<link media="only screen and (max-device-width: 480px)" href="./styles/ca_orbital/theme/iphone.css" type="text/css" rel="stylesheet" />

</head>

<body id="phpbb" class="section- ltr">
<div id="main">

<p class="top"><a id="top" name="top" accesskey="t"></a></p>

<div id="global" style="margin: 0 auto;">

    <p class="skiplink"><a href="#start_here">Skip to content</a></p>

	<!-- header start -->
    <div id="topnav">
        <div class="left"></div>
        <div class="right"></div>
        <ul class="linklist topnav leftside">
            <li>
                <a href="https://the-starport.com" title="The Starport">The Starport</a>
            </li>
            <li>
                <span>&bull;</span>
                <a href="https://the-starport.net/discord" title="The Starport Discord">Discord</a>
            </li>
        </ul>
    </div>
    

	<div id="logo"><a href="./index.php.html"><img src="./styles/ca_orbital/imageset/tlr_logo.png" alt="" title=""><span>Lancers Reactor Forums</span></a></div>
	<!-- header end -->

    <div id="page-header-msg">
		<div class="block-header"><span></span><div></div></div>
       <div class="block-content"><div class="block-inner"><div class="block-inner2">
            	
		<table width="100%">
			<tbody><tr><td style="text-align:center;width:100%;">

            <h2 style="color:red;">Important Message</h2>
            <h3>You are browsing the archived Lancers Reactor forums. You cannot register or login.<br>
            The content may be outdated and links may not be functional.</h3><br>
            <h4>To get the latest in Freelancer news, mods, modding and downloads, go to<br>
            	<a href="https://the-starport.com">The-Starport</a></h4>
    	</td></tr> 
    </tbody></table>
    
    	</div></div></div>
    <div class="block-footer"><span></span><div></div></div>
	</div>
    <p></p>
	<div id="page-header">
		<div class="navbar navbar-top" id="navbar-top">
            <div class="block-header"><span></span><div></div></div>
            <div class="block-content"><div class="block-inner"><div class="block-inner2">
            <ul class="linklist navlinks">
                <li class="icon-home"><span class="home-extra"><a href="./index.php.html" accesskey="h">Board index</a>  <strong>&#8249;</strong> <a href="./viewforum.php_f=75.html">Freelancer Editing</a> <strong>&#8249;</strong> </span><a href="./viewforum.php_f=30.html">Freelancer Editing Utilities Forum</a></li>
            </ul>
            <div class="block-clear"></div>
            </div></div></div>
            <div class="block-footer"><span></span><div></div></div>
		</div>
	</div>
    <p></p>

	<a name="start_here"></a>

	<div id="page-body">
		<div id="content-start"></div>
<h2 class="leftside"><a href="./viewtopic.php_f=30_t=36351" id="topic-title">Freelancer &quot;linting&quot; script - commandline junkies</a></h2>

<p class="rightside">
    
</p>
<div class="clear"></div>
<p class="forum-desc">Here you can find the postings on the different editing utilities found for Freelancer</p>

<div class="topic-actions">

	<div class="buttons">
	
		<div class="reply-icon"><a href="" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="pagination">
			1 post
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	

</div>
<div class="clear"></div>


	<div id="p27260" class="post">
		<div class="block-border block-block block-post block-post-first"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-0" href="javascript:void(0);">WatercoolerWarrior</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Sat Nov 27, 2004 7:15 am <span class="post-author-inline" style="display: none;">by WatercoolerWarrior</span></p>

			<h3 class="first"><a href="#p27260" class="post-subject">Freelancer &quot;linting&quot; script - commandline junkies</a></h3>

			

			<div class="content">Below is VBScript code that can be used to 'lint' a Freelancer data INI file (e.g., decoded BINI files - won't work for Freelancer.ini, etc.).  It is no-frills at this point, and has to be executed from the commandline. Here's how to use it; instructions are intended for people already comfortable with the commandline.
<br />
<br />1 - Make sure you have WSH 5.6 installed; it comes with Windows XP and newer already, or can be downloaded from <a href='http://www.microsoft.com/scripting' Target=_Blank>Microsoft's Scripting Technologies web site</a>.
<br />
<br />2 - Save the code to a file with a .vbs extension; for example, flint.vbs.
<br />
<br />3. - Run it. You need to explicitly use the WSH console variant (cscript) to execute the script, and redirect input from the file you want to test. So for example, if you saved the file to &quot;C:\My Temp Files\flint.vbs&quot; and want to test 
<br />&quot;C:\Program Files\Microsoft Games\Freelancer\DATA\SHIPS\shiparch.ini&quot;, you would do this:
<br />
<br />&lt;pre&gt;&lt;font size=1 face=Courier&gt;cscript &quot;C:\My Temp Files\flint.vbs&quot; &lt; &quot;C:\Program Files\Microsoft Games\Freelancer\DATA\SHIPS\shiparch.ini&quot;  &lt;/font&gt;&lt;/pre&gt;
<br />
<br />Note that this isn't very useful for testing stock files or FL SDK files; the &quot;errors&quot; it will pick up are either errors Freelancer is theoretically able to handle OK or apparently correct usage (such as the &quot;assertion&quot; lines in navbar.ini  - behavior/mesh/event etc.)
<br />
<br />&lt;pre&gt;&lt;font size=1 face=Courier&gt;
<br />' Parses a decompressed Freelancer INI file looking for possible errors.
<br />' Copyright: This is my work and I hereby place it in the public domain.
<br />
<br />Option Explicit
<br />Dim namedArgs: Set namedArgs = WScript.Arguments.Named
<br />
<br />' m_Warn controls whether warnings for bad values are shown.
<br />Dim m_Warn: m_Warn = True
<br />If namedArgs.Exists(&quot;W&quot; ) and namedArgs(&quot;W&quot; ) = False Then
<br />	m_Warn = False
<br />End If
<br />
<br />' Set this flag if we want good data written to stdout.
<br />Dim m_Output: m_Output = False
<br />If namedArgs.Exists(&quot;O&quot; ) Then m_Output = True
<br />
<br />' Global declaration of the  regex used in procedure TrimNoise().
<br />Dim rx: set rx = New Regexp: rx.Global = True
<br />
<br />' This is a quick regex for whitespacish characters. In theory, most should
<br />' never show up in a data segment, but let's be cautious anyway.
<br />' This will also make sure we treat ASCII 160 as a space.
<br />' The NON-noise set is thus the following:
<br />'             !&quot;#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNO
<br />'             PQRSTUVWXYZ[\^_`abcdefghijklmnopqrstuvwxyz{/}~
<br />Const noisePattern = &quot;[\x00-\x20\x7f-\xff+&quot;
<br />
<br />'Main processing loop
<br />Do While Not WScript.StdIn.AtEndofStream
<br />	Dim originalData: originalData = WScript.StdIn.ReadLine()
<br />	Dim data: data = TrimNoise(TrimComments(originalData))
<br />	If Len(data) = 0 Then
<br />		' This is just a spacing line; pass it on.
<br />		WriteOutput vbNullString
<br />	ElseIf Left(data, 1) = &quot;[&quot; Then
<br />		' Looks like a header
<br />		If Right(data, 1) &lt;&gt; Chr(93) Then
<br />			' Looks like a malformed header
<br />			' Chr(93) is a close bracket; using this to handle LTR forum posting.
<br />			WriteWarning WScript.StdIn.Line - 1, originalData, _
<br />				&quot;This may be a bad header.&quot;
<br />		Else
<br />			' Looks good; write it.
<br />			WriteOutput data
<br />		End If
<br />	ElseIf Right(data, 1) = Chr(93) Then
<br />		' Looks like a malformed header
<br />			' Chr(93) is a close bracket; using this to handle LTR forum posting.
<br />			WriteWarning WScript.StdIn.Line - 1, originalData, _
<br />				&quot;This may be a bad header.&quot;
<br />	Else
<br />		' This looks like a data line. Check for '='.
<br />		Dim elements: elements = Split(data, &quot;=&quot; )
<br />		Select Case UBound(elements)
<br />			Case 0, -1
<br />				' Only 1 element. This is apparently anomalous other than in
<br />				' \Data\Interface\Baseside\navbar.ini
<br />				WriteWarning WScript.StdIn.Line - 1, originalData, _
<br />					&quot;No '=' found; may be anomalous value unless in navbar.ini.&quot;
<br />				' We still write it out since it is possibly OK and since
<br />				' Freelancer seems to cope with it OK.
<br />				WriteOutput data
<br />			Case 1
<br />				elements(0) = TrimNoise(0): elements(1) = TrimNoise(1)
<br />				if Len(elements(0)) = 0 or Len(elements(1)) = 0 Then
<br />					' We are missing a name or a value. This is an error.
<br />					WriteWarning WScript.StdIn.Line - 1, originalData, _
<br />						&quot;Missing a keyname or a value.&quot;
<br />				Else
<br />					' Looks good; write it out.
<br />					WriteOutput Join(elements, &quot; = &quot; )
<br />				End If
<br />			Case Else
<br />				WriteWarning WScript.StdIn.Line - 1, originalData, _
<br />					&quot;Extra '=' in data.&quot;
<br />		End Select
<br />	End If
<br />Loop
<br />
<br />' End of main processing loop; the rest of this is declarations
<br />' of procedures used in code above.
<br />
<br />function TrimComments(ByVal s)
<br />	' this is specifically designed to strip extraneous material
<br />	' from a decompressed Freelancer Ini file line.
<br />	TrimComments = vbNullString
<br />	' we leave if a line is empty
<br />	If len(s) = 0 Then Exit Function
<br />	' we assume there is NO way a semicolon can be meaningful data.
<br />	' There is one possible exception; a quoted semicolon in keymap.ini
<br />	' could cause a problem; we eventually need to fix this.
<br />	' For now, it is probably better to work it this way.
<br />	Dim semicolon: semicolon = &quot;;&quot;
<br />	if left(s,1) = semicolon Then Exit Function
<br />	If InStr(s, semicolon) &gt; 0 Then s = Left(s, InStr(s, semicolon) - 1)
<br />	TrimComments = s
<br />End Function
<br />
<br />' Removes whatever characters we want to call &quot;noise&quot; from the start
<br />' and end of a string.
<br />function TrimNoise(ByVal s)
<br />	rx.Pattern = &quot;^&quot; &amp; noisePattern
<br />	s = rx.Replace(s, vbNullString)
<br />	rx.Pattern = noisePattern &amp; &quot;$&quot;
<br />	s = rx.Replace(s, vbNullString)
<br />	TrimNoise = s
<br />End Function
<br />
<br />Sub WriteWarning(ByVal line, ByVal data, ByVal comment)
<br />	If m_Warn Then
<br />		WScript.StdErr.WriteLine &quot;Possible error on line &quot; &amp; line &amp; &quot;.&quot;
<br />		WScript.StdErr.WriteLine &quot;data: &quot; &amp; data
<br />		WScript.StdErr.WriteLine &quot;Comments: &quot; &amp; comment
<br />		WScript.StdErr.WriteLine
<br />	End If
<br />End Sub
<br />
<br />Sub WriteOutput(ByVal s)
<br />	If m_Output Then
<br />		WScript.Stdout.Writeline s
<br />	End If
<br />End Sub
<br />  &lt;/font&gt;&lt;/pre&gt;
<br />
<br />Edited by - WatercoolerWarrior on 11/27/2004 7:18:18 AM
<br />
<br />Edited by - WatercoolerWarrior on 11/27/2004 7:20:04 AM</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>



<div class="topic-actions">
	<div class="buttons" id="viewtopic-buttons">
	
		<div class="reply-icon"><a href="" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="pagination">
			1 post
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	
</div>


	<p></p><p><a href="./viewforum.php_f=30" class="left-box left" accesskey="r">Return to Freelancer Editing Utilities Forum</a></p>

	<br /><br />
</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
</div>

	<div id="footer-clear">&nbsp;</div>
	<div class="copyright">
        <br />Hosted by <a href="https://the-starport.com">The Starport</a> &bull; Theme by <a href="https://www.stsoftware.biz/" ref="nofollow">ST Software</a>
	</div>


</div><!-- #global -->

</div>
</body>
</html>