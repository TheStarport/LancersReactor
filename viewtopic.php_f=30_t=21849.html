<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>


<style type="text/css">
#global { width: 100%; }
</style>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />


<title>Lancers Reactor Forums &bull; View topic - Single mesh -&gt; Multiple mesh VMeshData/Ref converter uplo</title>

<link href="./styles/ca_orbital/theme/stylesheet.css" rel="stylesheet" type="text/css" media="screen, projection" />
<link media="only screen and (max-device-width: 480px)" href="./styles/ca_orbital/theme/iphone.css" type="text/css" rel="stylesheet" />

</head>

<body id="phpbb" class="section- ltr">
<div id="main">

<p class="top"><a id="top" name="top" accesskey="t"></a></p>

<div id="global" style="margin: 0 auto;">

    <p class="skiplink"><a href="#start_here">Skip to content</a></p>

	<!-- header start -->
    <div id="topnav">
        <div class="left"></div>
        <div class="right"></div>
        <ul class="linklist topnav leftside">
            <li>
                <a href="https://the-starport.com" title="The Starport">The Starport</a>
            </li>
            <li>
                <span>&bull;</span>
                <a href="https://the-starport.net/discord" title="The Starport Discord">Discord</a>
            </li>
        </ul>
    </div>
    

	<div id="logo"><a href="./index.php.html"><img src="./styles/ca_orbital/imageset/tlr_logo.png" alt="" title=""><span>Lancers Reactor Forums</span></a></div>
	<!-- header end -->

    <div id="page-header-msg">
		<div class="block-header"><span></span><div></div></div>
       <div class="block-content"><div class="block-inner"><div class="block-inner2">
            	
		<table width="100%">
			<tbody><tr><td style="text-align:center;width:100%;">

            <h2 style="color:red;">Important Message</h2>
            <h3>You are browsing the archived Lancers Reactor forums. You cannot register or login.<br>
            The content may be outdated and links may not be functional.</h3><br>
            <h4>To get the latest in Freelancer news, mods, modding and downloads, go to<br>
            	<a href="https://the-starport.com">The-Starport</a></h4>
    	</td></tr> 
    </tbody></table>
    
    	</div></div></div>
    <div class="block-footer"><span></span><div></div></div>
	</div>
    <p></p>
	<div id="page-header">
		<div class="navbar navbar-top" id="navbar-top">
            <div class="block-header"><span></span><div></div></div>
            <div class="block-content"><div class="block-inner"><div class="block-inner2">
            <ul class="linklist navlinks">
                <li class="icon-home"><span class="home-extra"><a href="./index.php.html" accesskey="h">Board index</a>  <strong>&#8249;</strong> <a href="./viewforum.php_f=75.html">Freelancer Editing</a> <strong>&#8249;</strong> </span><a href="./viewforum.php_f=30.html">Freelancer Editing Utilities Forum</a></li>
            </ul>
            <div class="block-clear"></div>
            </div></div></div>
            <div class="block-footer"><span></span><div></div></div>
		</div>
	</div>
    <p></p>

	<a name="start_here"></a>

	<div id="page-body">
		<div id="content-start"></div>
<h2 class="leftside"><a href="./viewtopic.php_f=30_t=21849" id="topic-title">Single mesh -&gt; Multiple mesh VMeshData/Ref converter uplo</a></h2>

<p class="rightside">
    
</p>
<div class="clear"></div>
<p class="forum-desc">Here you can find the postings on the different editing utilities found for Freelancer</p>

<div class="topic-actions">

	<div class="buttons">
	
		<div class="reply-icon"><a href="" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="pagination">
			8 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	

</div>
<div class="clear"></div>


	<div id="p14992" class="post">
		<div class="block-border block-block block-post block-post-first"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-0" href="javascript:void(0);">redeye</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Thu Jul 24, 2003 8:04 am <span class="post-author-inline" style="display: none;">by redeye</span></p>

			<h3 class="first"><a href="#p14992" class="post-subject">Single mesh -&gt; Multiple mesh VMeshData/Ref converter uplo</a></h3>

			

			<div class="content">This is a command line utility that reads in a VMeshData and VMeshRef segment then outputs a new VMeshData segment and the relevant number of VMeshRef segments for you to import into a FL .cmp file.
<br />
<br />Basically it removes the hassle of hex editing from <a href='http://www.lancersreactor.com/t/forum/topic.asp?topic_id=21416&amp;forum_id=29&amp;Topic_Title=%2A%2ATUTORIAL%2A%2A+Ships%2FWeapons+w%2F+multiple+components&amp;forum_title=Freelancer+Editing+Tutorial+Forum&amp;cat_title=Freelancer+Editing&amp;M=False' Target=_Blank>this tutorial</a> which describes how to manually convert a single mesh .cmp into one with multiple components.
<br />
<br />Multiple components are required for ships having destructable parts/bay doors, custom weapon models, jumpgates that open and docking bay doors on stations.  
<br />
<br />At the moment this is very basic.  You must export your model from milkshape as normal, making sure that each component is a separate group.  Once you have done this open up the .cmp file and export the <b>VMeshLibrary -&gt; yourmodelname.lod0.vms -&gt; VMeshData   </b> node and the <b>yourmodelname.3db -&gt; Multilevel -&gt; Level0 -&gt; VMeshPart -&gt; VMeshRef   </b> node to separate file e.g. to two files called 'VMeshData' and 'VMeshRef'. 
<br />
<br />Move these files to the directory where you have the converter (i.e. the directory where you have put the file meshconv.exe).  Now run the converter, the syntax is :
<br />
<br />meshconv <b>VMeshData_filename  VMeshRef_filename   </b>
<br />
<br />So if you used the filenames from above you would type :
<br />
<br />meshconv vmeshdata vmeshref
<br />
<br />It exports the new VMeshData segment to a file called 'newvdata' and the VMeshRef segments to files called 'meshref1', 'meshref2' etc.  If these files already exist they will be overwritten.  The 'meshrefX' files will go up to 9 then start being called 'meshref:' etc so dont use more than 9 meshes.  I will sort this soon but dont really see any need for that many meshes so its not a priority.
<br />
<br />You then have to import the new VMeshData segment into your .cmp in place of the old one.  You will have to import the VMeshRef segments into the relevant <b>xxxxxx.3db -&gt; Multilevel -&gt; Level0 -&gt; VMeshPart -&gt; VMeshRef   </b> (as you only have one .3db node to start with you will have to make new ones manually, unless you are using a game .cmp as a template).
<br />
<br />Anyway thats a bit off topic, for more info on the .3db nodes etc. see the above tutorial link.  Downloading the <a href='http://www.lancersreactor.com/t/download/download.asp?id=441' Target=_Blank>Battleaxe</a> and using its .cmp as a template will allow you to easily see if a ship with multiple components is working.
<br />
<br />As i said, this is a very  basic version.  Ultimately i hope to get it to read in the .cmp and do all the converting automatically, outputting a new .cmp with the relevant nodes all in place.  Possibly with options for it to create Fix/Rev/Pris nodes for you aswell.  
<br />
<br />For the time being this will have to do <img src=smilies/icon_smile_wink.gif width=15 height=15 border=0 align=middle>  Remember it is very simple and not designed to cope with all sorts of crazy input.  If you give it valid VMeshData and VMeshRef it should work fine tho.
<br />
<br />Edited by - redeye on 25-07-2003 18:50:21
<br />
<br />Edited by - redeye on 31-07-2003 21:14:36</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>


	<div id="p179474" class="post">
		<div class="block-border block-block block-post"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-1" href="javascript:void(0);">Arachno</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Thu Jul 24, 2003 10:41 am <span class="post-author-inline" style="display: none;">by Arachno</span></p>

			<h3><a href="#p179474" class="post-subject"></a></h3>

			

			<div class="content">Hi, 
<br />I make some researching about correctly ship viewing.   
<br />
<br />VMeshRef
<br />{
<br />  dword 0x3c
<br />  dword VMeshID
<br />  word start_vert
<br />  word end_vert
<br />  word start_vert_reference
<br />  word end_vert_reference
<br />  word mesh_number
<br />  word number_of_meshes
<br />
<br />  float bounding_box[6 (minx, maxx, miny, maxy, minz, maxz)
<br />  float unknown[4
<br />} 
<br />
<br />array of variables &quot;unknown&quot; is important for ship view, when HpMount Hardpoint is out of screen.
<br />
<br />Example: proportions of TIE Avenger is 3 x 4 x 10m.
<br />
<br />               float bounding_box[6 (0.0, 3.0, 0.0, 4.0, 0.0, 10.0)
<br />               float unknown[4 (0.0, 0.0, 0.0, 10.0)
<br />
<br />
<br />My researching is in progress, but its work. <img src="./images/smilies/icon_smile.gif" alt=":-)" title="Smile" />
<br />
<br />Sorry ... my english ...
<br />
<br />Arachno</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>


	<div id="p179539" class="post">
		<div class="block-border block-block block-post"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-2" href="javascript:void(0);">redeye</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Thu Jul 24, 2003 2:51 pm <span class="post-author-inline" style="display: none;">by redeye</span></p>

			<h3><a href="#p179539" class="post-subject"></a></h3>

			

			<div class="content">Interesting.
<br />
<br />I had ignored the bounding box and unknowns as i couldnt see any difference if you removed them from the game ships.  HCls exporter writes them as all 00's and this converter only modifies the start/end vertex/vertex_reference numbers and the mesh_number/number_of_meshes bits.  Everything else is left the same.
<br />Keep me up to date with any information you get.
<br />
<br />Remember the end_vertex number is actually the number of vertexes that component uses and the end_vertex_reference number is actually how many vertexes that component references.</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>


	<div id="p179907" class="post">
		<div class="block-border block-block block-post"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-3" href="javascript:void(0);">Arachno</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Fri Jul 25, 2003 7:01 am <span class="post-author-inline" style="display: none;">by Arachno</span></p>

			<h3><a href="#p179907" class="post-subject"></a></h3>

			

			<div class="content">Difference is here :
<br /> example: I have big NPC capital ship (one piece, no destroyable comp.). When you are too close (landing), this ship disappear. Engine of Freelancer has not info about size of 3D object box. Problem is .sur file, because edges of this ship are &quot;no solid&quot;.</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>


	<div id="p179973" class="post">
		<div class="block-border block-block block-post"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-4" href="javascript:void(0);">GAG</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Fri Jul 25, 2003 10:05 am <span class="post-author-inline" style="display: none;">by GAG</span></p>

			<h3><a href="#p179973" class="post-subject"></a></h3>

			

			<div class="content">what are you guys using to open the Vmeshref files, is it a hex editor or something?</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>


	<div id="p180183" class="post">
		<div class="block-border block-block block-post"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-5" href="javascript:void(0);">redeye</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Fri Jul 25, 2003 5:49 pm <span class="post-author-inline" style="display: none;">by redeye</span></p>

			<h3><a href="#p180183" class="post-subject"></a></h3>

			

			<div class="content">Yeah, hex editor is your best bet.  If you use the converter you shouldnt have to touch them tho.  It shouldnt be much hassle to tweak the converter a bit to make it include the Bounding Box figures.  Hopefully, like Arachno says, this will solve the problem with huge ships disappearing.  Or will the .sur file still be a problem?
<br />
<br />I'll post when its done.
<br />
<br />EDIT - New version now calculates Bounding Box etc.   
<br />
<br />Version 0.7b :
<br />
<br />This is a new version of the VMeshData / VMeshRef converter. Basic function remains the same, read in VMeshData anf Ref segments from an exported Freelancer .cmp and rewrites them to allow use of ships/weapons with multiple components.
<br />
<br />This time support has been added for the Bounding Box figures in the VMeshRef segments. These are not written by the .cmp exporter but are probably important for correct viewing of large ships/stations. It is possible to feed in a single mesh, single objects VMesh segments just to get the Bounding Box figures.
<br />
<br />Support has also been added for writing VMeshRef segments which span several meshes. This allows components made from separate Milkshape groups to be lumped together as one object in the .cmp.
<br />
<br />Worked examples of common uses are provided.
<br />
<br />Template .cmp files are included for a ship with destructable parts and a custom weapon model file along with complete instructions to get ships/weapons from Milkshape to a correctly defined .cmp file (no hex editing involved ).
<br />
<br />Can now handle up to 100 separate meshes.
<br />
<br />See included readme for full details/instructions.
<br />
<br />Get it <a href='http://www.lancersreactor.com/t/download/download.asp?id=464' Target=_Blank>here</a>
<br />
<br />Edited by - redeye on 31-07-2003 21:14:05</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>


	<div id="p257220" class="post">
		<div class="block-border block-block block-post"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-6" href="javascript:void(0);">Firewing</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Fri Mar 05, 2004 7:57 am <span class="post-author-inline" style="display: none;">by Firewing</span></p>

			<h3><a href="#p257220" class="post-subject"></a></h3>

			

			<div class="content">Will this calculate the bounding boxes of smaller ships too?
<br />
<br />Allso, is there some way to make a custom sur file?</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>


	<div id="p265804" class="post">
		<div class="block-border block-block block-post"><div class="block-header"><span></span><div></div></div><div class="block-content"><div class="block-inner"><div class="block-inner2">
        <div class="post-maximize" style="display: none;"></div>
        <div class="post-profile-block">
        <div class="profile-block">
        <div class="postprofile">
            <div class="profile-top">
                <p class="profile-author">
                    <a class="profile-link popup-link" id="popup-link-7" href="javascript:void(0);">redeye</a>
                </p>
                
            </div>
            

            <div class="profile-details">
                
            </div>
		</div>
		</div>
		</div>
		

        
		<div class="postbody">
		    <div class="post-content">
			

			<p class="author"><a href=""><img src="./styles/ca_orbital/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a> Sun Mar 28, 2004 5:03 am <span class="post-author-inline" style="display: none;">by redeye</span></p>

			<h3><a href="#p265804" class="post-subject"></a></h3>

			

			<div class="content">Yes, it will.... as far as i rememeber anyway <img src=smilies/icon_smile_wink.gif width=15 height=15 border=0 align=middle>  You should be able to feed it in a single mesh and it will calculate the bounding box figures for you.
<br />
<br />However i'm not sure if this was ever shown to give any sort of benefit, I only put the feature in 'cause of what that Arachno guy was saying and he never got back to me on whether it had any effect.
<br />
<br />Custom .sur files are still incredibly difficult.  There are some stickied posts on the Editing Forum detailing th latest progress.  The best i ever got was to modify nodes on existing .sur files - but if you look at the more recent posts they're doing some crazy maths.  Good luck to them.</div>

			
            </div>

		
            <ul class="profile-icons">
        		<li class="top-icon"><a href="#top" class="top" title="Top"><span>Top</span></a></li>
                
            </ul>
		

            <div class="clear"></div>
		</div>

        

		<div class="block-clear"></div></div></div></div><div class="block-footer"><span></span><div></div></div></div>
	</div>



<div class="topic-actions">
	<div class="buttons" id="viewtopic-buttons">
	
		<div class="reply-icon"><a href="" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="pagination">
			8 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	
</div>


	<p></p><p><a href="./viewforum.php_f=30" class="left-box left" accesskey="r">Return to Freelancer Editing Utilities Forum</a></p>

	<br /><br />
</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
</div>

	<div id="footer-clear">&nbsp;</div>
	<div class="copyright">
        <br />Hosted by <a href="https://the-starport.com">The Starport</a> &bull; Theme by <a href="https://www.stsoftware.biz/" ref="nofollow">ST Software</a>
	</div>


</div><!-- #global -->

</div>
</body>
</html>